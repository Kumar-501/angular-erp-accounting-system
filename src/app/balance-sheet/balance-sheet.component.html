<div class="balance-sheet">
<div class="balance-sheet">
  <!-- Header Section -->
  <div class="sheet-header">
    <div class="header-top">
      <h1>Balance Sheet</h1>
      
      <div class="header-controls">
        <!-- Date Range & Apply Button Group -->
<div class="filter-controls">
  <!-- FROM DATE -->
  <div class="date-group">
    <label for="fromDate">From:</label>
    <div class="date-input-wrapper">
      <input 
        id="fromDate" 
        type="text" 
        class="form-control date-input" 
        [value]="getFormattedDate(fromDate)"
        (blur)="onDateInput($event, 'from')"
        (keyup.enter)="onDateInput($event, 'from')"
        placeholder="DD-MM-YYYY"
        maxlength="10">
      <button type="button" class="calendar-btn" (click)="openDatePicker('from')">
        <i class="fas fa-calendar-alt"></i>
      </button>
      <!-- Hidden actual date input -->
      <input 
        #fromDatePicker
        type="date" 
        class="hidden-date-picker" 
        [(ngModel)]="fromDate">
    </div>
  </div>
  
  <!-- TO DATE -->
  <div class="date-group">
    <label for="toDate">To:</label>
    <div class="date-input-wrapper">
      <input 
        id="toDate" 
        type="text" 
        class="form-control date-input" 
        [value]="getFormattedDate(toDate)"
        (blur)="onDateInput($event, 'to')"
        (keyup.enter)="onDateInput($event, 'to')"
        placeholder="DD-MM-YYYY"
        maxlength="10">
      <button type="button" class="calendar-btn" (click)="openDatePicker('to')">
        <i class="fas fa-calendar-alt"></i>
      </button>
      <!-- Hidden actual date input -->
      <input 
        #toDatePicker
        type="date" 
        class="hidden-date-picker" 
        [(ngModel)]="toDate">
    </div>
  </div>

  <button class="btn btn-primary apply-btn" (click)="generateBalanceSheet(true)" [disabled]="isLoading">
    <i class="fas fa-filter" *ngIf="!isLoading"></i> 
    <i class="fas fa-spinner fa-spin" *ngIf="isLoading"></i>
    {{ isLoading ? 'Generating...' : 'Apply Filter' }}
  </button>
</div>

        <!-- Export Actions -->
        <div class="export-controls">
          <button class="btn btn-outline" (click)="printBalanceSheet()">
            <i class="fas fa-print"></i> Print
          </button>
          <button class="btn btn-outline" (click)="exportToExcel()">
            <i class="fas fa-file-excel"></i> Excel
          </button>
        </div>
      </div>
    </div>

    <!-- Company & Report Details -->
    <div class="company-info">
      <h2>HERBALY TOUCH AYURVEDA HOSPITAL PRIVATE LIMITED</h2>
      <p class="report-title">Balance Sheet as on {{ toDate | date:'longDate' }}</p>
      <p class="report-period">
        (Period: {{ fromDate | date:'mediumDate' }} to {{ toDate | date:'mediumDate' }})
      </p>
    </div>

    <div class="summary-info">
      <span>Closing Stock: <strong>{{ formatCurrency(balanceSheetData.stockData.closingStock) }}</strong></span>
    </div>
  </div>

  <!-- Loading Indicator -->
  <div *ngIf="isLoading" class="loading-indicator">
    <div class="spinner"></div>
    <span>Generating balance sheet...</span>
  </div>

  <!-- ... Rest of your content (Tables, etc.) ... -->
  <div *ngIf="isLoading" class="loading-indicator">
    <div class="spinner"></div>
    <span>Generating balance sheet...</span>
  </div>

  <!-- Main Content: Two Columns -->
  <div *ngIf="!isLoading && balanceSheetData.equity.length > 0" class="sheet-content">
    <div class="financial-sections">
      <!-- Left Column: Liabilities & Equity -->
      <div class="financial-column left">
        <div class="financial-section liabilities">
          <h3>Liabilities</h3>
          <table>
            <thead>
              <tr>
                <th class="account-name">Account Name</th>
                <th class="account-number">Account No.</th>
                <th class="account-head">Account Head</th>
                <th class="amount">Amount (₹)</th>
              </tr>
            </thead>
            <tbody>
              <ng-container *ngFor="let item of balanceSheetData.liabilities">
                <tr [class.category-row]="item.isCategory">
                  <td class="account-name" [class.category-name]="item.isCategory">{{ item.name }}</td>
                  <td class="account-number">{{ item.accountNumber }}</td>
                  <td class="account-head">{{ item.accountHead }}</td>
                  <td class="amount" [class.category-amount]="item.isCategory">{{ formatCurrency(item.value) }}</td>
                </tr>
              </ng-container>
              <tr class="total-row">
                <td colspan="3">Total Liabilities</td>
                <td class="amount">{{ formatCurrency(balanceSheetData.totals.liabilities) }}</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="financial-section equity">
          <h3>Equity</h3>
          <table>
            <thead>
              <tr>
                <th class="account-name">Account Name</th>
                <th class="account-number">Account No.</th>
                <th class="account-head">Account Head</th>
                <th class="amount">Amount (₹)</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of balanceSheetData.equity" [class.category-row]="item.isCategory">
                <td class="account-name" [class.category-name]="item.isCategory">{{ item.name }}</td>
                <td class="account-number">{{ item.accountNumber }}</td>
                <td class="account-head">{{ item.accountHead }}</td>
                <td class="amount" [class.category-amount]="item.isCategory">{{ formatCurrency(item.value) }}</td>
              </tr>
              <tr class="total-row">
                <td colspan="3">Total Equity</td>
                <td class="amount">{{ formatCurrency(balanceSheetData.totals.equity) }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Right Column: Assets -->
      <div class="financial-column right">
        <div class="financial-section assets">
          <h3>Assets</h3>
          <table>
            <thead>
              <tr>
                <th class="account-name">Account Name</th>
                <th class="account-number">Account No.</th>
                <th class="account-head">Account Head</th>
                <th class="amount">Amount (₹)</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of balanceSheetData.assets" [class.category-row]="item.isCategory">
                <td class="account-name" [class.category-name]="item.isCategory">{{ item.name }}</td>
                <td class="account-number">{{ item.accountNumber }}</td>
                <td class="account-head">{{ item.accountHead }}</td>
                <td class="amount" [class.category-amount]="item.isCategory">{{ formatCurrency(item.value) }}</td>
              </tr>
              <tr class="total-row">
                <td colspan="3">Total Assets</td>
                <td class="amount">{{ formatCurrency(balanceSheetData.totals.assets) }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Financial Summary Footer -->
    <div class="financial-summary">
      <h4>Financial Summary</h4>
      <div class="summary-details">
        <div class="summary-item">
          <span>Equity</span>
          <span>{{ formatCurrency(balanceSheetData.totals.equity) }}</span>
        </div>
        <div class="summary-item">
          <span>Liabilities</span>
          <span>{{ formatCurrency(balanceSheetData.totals.liabilities) }}</span>
        </div>
        <div class="summary-item">
          <span>Assets</span>
          <span>{{ formatCurrency(balanceSheetData.totals.assets) }}</span>
        </div>
      </div>

      <!-- Tax Summary Section -->
      <div class="tax-summary">
        <h5>Tax Summary</h5>
        <div class="tax-details">
          <div class="tax-item">
            <span>Output Tax Payable:</span>
            <span>{{ formatCurrency(balanceSheetData.taxData.taxPayable) }}</span>
          </div>
          <div class="tax-item">
            <span>Input Tax Credit:</span>
            <span>{{ formatCurrency(balanceSheetData.taxData.taxReceivable) }}</span>
          </div>
        </div>
      </div>

      <div class="balance-status" [ngClass]="getBalanceSheetStatus().toLowerCase()">
        <span class="status-dot"></span>
        <span class="status-text">{{ getBalanceSheetStatus() }}</span>
      </div>
      <div class="balance-totals">
        <div class="total-line">
          <span>Assets</span>
          <span>=</span>
          <span>Equity + Liabilities</span>
        </div>
        <div class="total-line">
          <strong>{{ formatCurrency(balanceSheetData.totals.assets) }}</strong>
          <span>=</span>
          <strong>{{ formatCurrency(balanceSheetData.totals.equity + balanceSheetData.totals.liabilities) }}</strong>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="!isLoading && balanceSheetData.equity.length === 0" class="no-data-message">
    <i class="fas fa-file-alt"></i>
    <p>No balance sheet data available.</p>
    <p>Please select a date and click "Generate" to view the report.</p>
  </div>
</div>