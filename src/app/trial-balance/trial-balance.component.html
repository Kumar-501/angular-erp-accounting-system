<div class="trial-balance-container">
  <div class="header-section">
    <h1>Trial Balance</h1>
    <div class="controls">
      <div class="date-range">
        <label>As on:</label>
        <input type="date" [(ngModel)]="asOfDate" (change)="generateTrialBalance()">
        <button (click)="generateTrialBalance()" [disabled]="isLoading">
          {{ isLoading ? 'Generating...' : 'Generate' }}
        </button>
      </div>
      <div class="export-options">
        <button (click)="exportToExcel()" class="export-btn excel">
          <i class="fas fa-file-excel"></i> Excel
        </button>
        <button (click)="exportToPDF()" class="export-btn pdf">
          <i class="fas fa-file-pdf"></i> PDF
        </button>
        <button (click)="printReport()" class="export-btn print">
          <i class="fas fa-print"></i> Print
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="isLoading" class="loading-indicator">
    <div class="spinner"></div>
    <span>Generating trial balance...</span>
  </div>
  <div *ngIf="!isLoading && trialBalanceData.length > 0" class="trial-balance-content">
    <div class="company-header">
      <h2>HERBALY TOUCH AYURVEDA PRODUCTS PRIVATE LIMITED</h2>
      <p>Trial Balance as on {{ asOfDate | date:'longDate' }}</p>
      <div class="info-note">
        <i class="fas fa-info-circle"></i>
        <span>This trial balance shows the debit and credit balances for each account in a simplified format.</span>
      </div>
    </div><div class="table-wrapper">
      <table class="trial-balance-table">
        <thead>
          <tr>
            <th class="account-name">Account Name</th>
            <th class="account-number">Account No.</th>
            <th class="account-head">Account Head</th>
            <th class="debit-amount">Debit (₹)</th>
            <th class="credit-amount">Credit (₹)</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of trialBalanceData" [class]="'account-type-' + item.accountType.toLowerCase()">
            <td class="account-name">{{ item.accountName }}</td>
            <td class="account-number">{{ item.accountNumber }}</td>
            <td class="account-head">{{ item.accountHead }}</td>
            <td class="debit-amount">{{ item.debit > 0 ? (item.debit | number:'1.2-2') : '-' }}</td>
            <td class="credit-amount">{{ item.credit > 0 ? (item.credit | number:'1.2-2') : '-' }}</td>
          </tr>
        </tbody>
        <tfoot>
          <tr class="total-row">
            <td colspan="3"><strong>Total</strong></td>
            <td class="debit-amount"><strong>{{ totalDebit | number:'1.2-2' }}</strong></td>
            <td class="credit-amount"><strong>{{ totalCredit | number:'1.2-2' }}</strong></td>
          </tr>
          <tr class="difference-row" *ngIf="!isBalanced">
            <td colspan="3"><strong>Difference</strong></td>
            <td class="debit-amount">
              <strong>{{ difference > 0 ? (difference | number:'1.2-2') : '-' }}</strong>
            </td>
            <td class="credit-amount">
              <strong>{{ difference < 0 ? (absDifference | number:'1.2-2') : '-' }}</strong>
            </td>
          </tr>
        </tfoot>
      </table>
    </div><div class="summary-section">
      <div class="summary-card">
        <h3>Trial Balance Summary</h3>
        <div class="summary-item">
          <span>Total Debit:</span>
          <span>₹{{ totalDebit | number:'1.2-2' }}</span>
        </div>
        <div class="summary-item">
          <span>Total Credit:</span>
          <span>₹{{ totalCredit | number:'1.2-2' }}</span>
        </div>
        <div class="summary-item" *ngIf="!isBalanced">
          <span>Difference:</span>
          <span [class.positive]="difference > 0" [class.negative]="difference < 0">
            ₹{{ absDifference | number:'1.2-2' }} {{ difference > 0 ? '(Debit excess)' : '(Credit excess)' }}
          </span>
        </div>
        <div class="summary-item status">
          <span>Status:</span>
          <span [class.balanced]="isBalanced" [class.unbalanced]="!isBalanced">
            {{ isBalanced ? '✅ Balanced' : '⚠️ Unbalanced' }}
          </span>
        </div>
      </div>

      <!-- Account Type Summary -->
      <div class="summary-card account-types">
        <h3>Account Type Breakdown</h3>
        <div *ngFor="let group of accountTypeGroups" class="type-summary">
          <div class="type-header">
            <span class="type-badge" [class]="'type-' + group.type.toLowerCase()">{{ group.type }}</span>
            <span class="account-count">({{ group.accounts.length }} accounts)</span>
          </div>
          <div class="type-totals">
            <span>Debit: ₹{{ group.totalDebit | number:'1.2-2' }}</span>
            <span>Credit: ₹{{ group.totalCredit | number:'1.2-2' }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="!isLoading && trialBalanceData.length === 0" class="no-data">
    <i class="fas fa-file-alt"></i>
    <p>No trial balance data available</p>
    <p>Please select a date and generate the report</p>
  </div>
</div>