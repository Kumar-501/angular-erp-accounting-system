<!-- trial-balance.component.html -->

<div class="trial-balance-page">
  <!-- Report Header -->
  <div class="report-header-main">
    <h2>HERBALY TOUCH AYURVEDA PRODUCTS PVT LTD</h2>
    <h3>Trial Balance</h3>
    <p>From {{ startDate | date:'dd-MMM-yyyy' }} to {{ endDate | date:'dd-MMM-yyyy' }}</p>
    
    <!-- REMOVED: The Profit/Loss Status Display has been removed from the header -->
    
    <!-- Filters and Actions -->
    <div class="report-actions">
<!-- Inside the report-actions section -->
<div class="period-selector">
  <label for="start-date">Start Date:</label>
  <div class="date-input-wrapper">
    <input type="text" 
           class="form-control date-input" 
           [value]="getFormattedDateForInput(startDate)"
           (blur)="onManualDateInput($event, 'start')"
           placeholder="DD-MM-YYYY">
    <button type="button" class="calendar-btn" (click)="openDatePicker('start')">
      <i class="fas fa-calendar-alt"></i>
    </button>
    <input #startDatePicker 
           id="start-date"
           type="date" 
           class="hidden-date-picker" 
           [(ngModel)]="startDate" 
           (change)="generateTrialBalance()">
  </div>
</div>

<div class="period-selector">
  <label for="end-date">End Date:</label>
  <div class="date-input-wrapper">
    <input type="text" 
           class="form-control date-input" 
           [value]="getFormattedDateForInput(endDate)"
           (blur)="onManualDateInput($event, 'end')"
           placeholder="DD-MM-YYYY">
    <button type="button" class="calendar-btn" (click)="openDatePicker('end')">
      <i class="fas fa-calendar-alt"></i>
    </button>
    <input #endDatePicker 
           id="end-date"
           type="date" 
           class="hidden-date-picker" 
           [(ngModel)]="endDate" 
           (change)="generateTrialBalance()">
  </div>
</div>
        <button class="btn-export" (click)="exportToExcel()" [disabled]="isLoading || trialBalanceData.items.length === 0">
          <i class="fas fa-download"></i> Export
        </button>
    </div>
  </div>

  <!-- Report Body -->
  <div class="report-body card">
    <div *ngIf="isLoading" class="loading-overlay">
      <div class="spinner-border text-primary" role="status"></div>
      <p>Generating Report...</p>
    </div>
    
    <div *ngIf="!isLoading" class="card-body">
      <div *ngIf="errorMessage" class="alert alert-danger">
        {{ errorMessage }}
      </div>

      <div class="table-responsive">
        <table class="table trial-balance-table" *ngIf="trialBalanceData.items.length > 0; else noData">
          <thead>
            <tr>
              <th class="text-start">Account Code</th>
              <th class="text-start">Particulars</th>
              <th class="text-start">Account Type</th>
              <th class="text-end">Debit (₹)</th>
              <th class="text-end">Credit (₹)</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of trialBalanceData.items">
              <td class="text-start">{{ item.accountCode }}</td>
              <td class="text-start">{{ item.accountName }}</td>
              <td class="text-start">{{ item.accountType }}</td>
              <td class="text-end font-monospace">{{ formatAmount(item.debit) }}</td>
              <td class="text-end font-monospace">{{ formatAmount(item.credit) }}</td>
            </tr>
          </tbody>
          <tfoot>
            <tr class="total-row">
              <td class="text-start fw-bold" colspan="3">TOTAL</td>
              <td class="text-end fw-bold font-monospace">{{ formatAmount(trialBalanceData.totals.debit) }}</td>
              <td class="text-end fw-bold font-monospace">{{ formatAmount(trialBalanceData.totals.credit) }}</td>
            </tr>
            <!-- <tr class="difference-row" *ngIf="trialBalanceData.difference !== 0">
              <td class="text-start fw-bold" colspan="3">DIFFERENCE</td>
              <td class="text-end fw-bold font-monospace" [class.text-danger]="trialBalanceData.difference !== 0" colspan="2">
                {{ formatAmount(Math.abs(trialBalanceData.difference)) }}
              </td>
            </tr> -->
          </tfoot>
        </table>
      </div>

      <ng-template #noData>
        <div class="no-data-message" *ngIf="!errorMessage">
          <i class="fas fa-folder-open"></i>
          <p>No data available to display for the selected date range.</p>
        </div>
      </ng-template>
    </div>
  </div>
</div>