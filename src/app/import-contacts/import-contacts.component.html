<div class="import-contacts-container">
  <div class="header-section">
    <div class="header-controls">
      <button class="btn-back" (click)="goToCustomers()">
        <i class="fa fa-arrow-left"></i> Back to Customers
      </button>
      <h2>Import Contacts</h2>
    </div>
  </div>

  <div class="import-content">
    <!-- Upload Section -->
    <div class="upload-section">
      <div class="upload-box">
        <div class="upload-header">
          <h3>Upload File</h3>
          <p>Select an Excel (.xlsx, .xls) or CSV file containing contact data</p>
        </div>

        <div class="file-input-container">
          <label for="fileUpload" class="file-input-label">
            <i class="fa fa-cloud-upload"></i>
            <span>Choose File</span>
          </label>
          <input 
            type="file" 
            id="fileUpload" 
            (change)="onFileSelected($event)" 
            accept=".xlsx,.xls,.csv" 
            [disabled]="importStatus === 'processing'" />
        </div>

        <div class="selected-file" *ngIf="selectedFile">
          <div class="file-info">
            <i class="fa fa-file-excel"></i>
            <span class="file-name">{{ selectedFile.name }}</span>
            <span class="file-size">({{ (selectedFile.size / 1024 / 1024).toFixed(2) }} MB)</span>
          </div>
        </div>

        <!-- Progress Section -->
        <div class="progress-section" *ngIf="importStatus === 'processing'">
          <div class="progress-container">
            <div class="progress-bar">
              <div class="progress-fill" [style.width.%]="importProgress"></div>
            </div>
            <span class="progress-text">{{ importProgress }}%</span>
          </div>
          <div class="processing-message">{{ processingMessage }}</div>
        </div>

        <!-- Result Section -->
        <div class="result-section" *ngIf="importStatus === 'success' || importStatus === 'error'">
          <div class="result-box" [class.success]="importStatus === 'success'" [class.error]="importStatus === 'error'">
            <div class="result-icon">
              <i class="fa" [class.fa-check-circle]="importStatus === 'success'" [class.fa-exclamation-circle]="importStatus === 'error'"></i>
            </div>
            <div class="result-content">
              <h4>{{ importStatus === 'success' ? 'Import Completed' : 'Import Failed' }}</h4>
              <div class="result-stats" *ngIf="importStatus === 'success'">
                <div class="stat">
                  <span class="stat-label">Successful:</span>
                  <span class="stat-value success">{{ importResult.success }}</span>
                </div>
                <div class="stat">
                  <span class="stat-label">Errors:</span>
                  <span class="stat-value error">{{ importResult.errors }}</span>
                </div>
              </div>
              <div class="error-messages" *ngIf="importResult.errorMessages.length > 0">
                <h5>Error Details:</h5>
                <ul>
                  <li *ngFor="let error of importResult.errorMessages.slice(0, 10)">{{ error }}</li>
                  <li *ngIf="importResult.errorMessages.length > 10">
                    ... and {{ importResult.errorMessages.length - 10 }} more errors
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
          <button 
            class="btn-template" 
            (click)="downloadTemplate()"
            [disabled]="importStatus === 'processing'">
            <i class="fa fa-download"></i> Download Template
          </button>
          
          <button 
            class="btn-submit" 
            (click)="onSubmit()" 
            [disabled]="!selectedFile || importStatus === 'processing'">
            <i class="fa fa-upload"></i> 
            {{ importStatus === 'processing' ? 'Processing...' : 'Import Contacts' }}
          </button>

          <button 
            class="btn-reset" 
            (click)="resetImport()"
            *ngIf="importStatus === 'success' || importStatus === 'error'">
            <i class="fa fa-refresh"></i> Import Another File
          </button>
        </div>
      </div>
    </div>

    <!-- Instructions Section -->
    <div class="instructions-section">
      <div class="instructions-box">
        <h3>
          <i class="fa fa-info-circle"></i>
          Import Instructions
        </h3>
        
        <div class="important-note">
          <strong>Important:</strong> Follow these instructions carefully before importing your file.
        </div>

        <div class="column-structure">
          <h4>Required Column Structure</h4>
          <p>The columns in your file should be in the following order:</p>
          
          <div class="table-container">
            <table class="instructions-table">
              <thead>
                <tr>
                  <th>Column #</th>
                  <th>Column Name</th>
                  <th>Required</th>
                  <th>Instructions</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>1</td>
                  <td>Contact Type</td>
                  <td><span class="required">Required</span></td>
                  <td>1 = Customer, 2 = Supplier, 3 = Both</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>Prefix</td>
                  <td><span class="optional">Optional</span></td>
                  <td>Mr, Mrs, Ms, Dr, etc.</td>
                </tr>
                <tr>
                  <td>3</td>
                  <td>First Name</td>
                  <td><span class="required">Required</span></td>
                  <td>Required for individuals</td>
                </tr>
                <tr>
                  <td>4</td>
                  <td>Middle Name</td>
                  <td><span class="optional">Optional</span></td>
                  <td></td>
                </tr>
                <tr>
                  <td>5</td>
                  <td>Last Name</td>
                  <td><span class="optional">Optional</span></td>
                  <td></td>
                </tr>
                <tr>
                  <td>6</td>
                  <td>Business Name</td>
                  <td><span class="conditional">Conditional</span></td>
                  <td>Required if contact type is supplier or both</td>
                </tr>
                <tr>
                  <td>7</td>
                  <td>Contact ID</td>
                  <td><span class="optional">Optional</span></td>
                  <td>Leave blank to auto-generate</td>
                </tr>
                <tr>
                  <td>8</td>
                  <td>Tax Number</td>
                  <td><span class="optional">Optional</span></td>
                  <td></td>
                </tr>
                <tr>
                  <td>9</td>
                  <td>Opening Balance</td>
                  <td><span class="optional">Optional</span></td>
                  <td>Numeric value, default is 0</td>
                </tr>
                <tr>
                  <td>10</td>
                  <td>Pay Term</td>
                  <td><span class="conditional">Conditional</span></td>
                  <td>Required if contact type is supplier or both</td>
                </tr>
                <tr>
                  <td>11</td>
                  <td>Pay Term Period</td>
                  <td><span class="conditional">Conditional</span></td>
                  <td>days or months</td>
                </tr>
                <tr>
                  <td>12</td>
                  <td>Credit Limit</td>
                  <td><span class="optional">Optional</span></td>
                  <td>Numeric value</td>
                </tr>
                <tr>
                  <td>13</td>
                  <td>Email</td>
                  <td><span class="optional">Optional</span></td>
                  <td>Valid email format</td>
                </tr>
                <tr>
                  <td>14</td>
                  <td>Mobile</td>
                  <td><span class="required">Required</span></td>
                  <td>10-digit mobile number</td>
                </tr>
                <tr>
                  <td>15</td>
                  <td>Alternate Contact</td>
                  <td><span class="optional">Optional</span></td>
                  <td>10-digit number</td>
                </tr>
                <tr>
                  <td>16</td>
                  <td>Landline</td>
                  <td><span class="optional">Optional</span></td>
                  <td>10-digit number</td>
                </tr>
                <tr>
                  <td>17</td>
                  <td>City</td>
                  <td><span class="optional">Optional</span></td>
                  <td></td>
                </tr>
                <tr>
                  <td>18</td>
                  <td>State</td>
                  <td><span class="optional">Optional</span></td>
                  <td></td>
                </tr>
                <tr>
                  <td>19</td>
                  <td>Country</td>
                  <td><span class="optional">Optional</span></td>
                  <td></td>
                </tr>
                <tr>
                  <td>20</td>
                  <td>Address Line 1</td>
                  <td><span class="optional">Optional</span></td>
                  <td></td>
                </tr>
                <tr>
                  <td>21</td>
                  <td>Address Line 2</td>
                  <td><span class="optional">Optional</span></td>
                  <td></td>
                </tr>
                <tr>
                  <td>22</td>
                  <td>Zip Code</td>
                  <td><span class="optional">Optional</span></td>
                  <td></td>
                </tr>
                <tr>
                  <td>23</td>
                  <td>Date of Birth</td>
                  <td><span class="optional">Optional</span></td>
                  <td>Format: YYYY-MM-DD (e.g., 2025-04-05)</td>
                </tr>
                <tr>
                  <td>24</td>
                  <td>Custom Field 1</td>
                  <td><span class="optional">Optional</span></td>
                  <td></td>
                </tr>
                <tr>
                  <td>25</td>
                  <td>Custom Field 2</td>
                  <td><span class="optional">Optional</span></td>
                  <td></td>
                </tr>
                <tr>
                  <td>26</td>
                  <td>Custom Field 3</td>
                  <td><span class="optional">Optional</span></td>
                  <td></td>
                </tr>
                <tr>
                  <td>27</td>
                  <td>Custom Field 4</td>
                  <td><span class="optional">Optional</span></td>
                  <td></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="tips-section">
          <h4>Tips for Successful Import</h4>
          <ul class="tips-list">
            <li>Download and use the provided template for best results</li>
            <li>Ensure mobile numbers are exactly 10 digits</li>
            <li>Use the correct contact type numbers (1, 2, or 3)</li>
            <li>Date format should be YYYY-MM-DD</li>
            <li>Remove any extra columns not specified in the template</li>
            <li>Ensure the first row contains headers as specified</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div class="footer-text">
    HYBRID CRM - V6.2 | Copyright Â© 2025 All rights reserved.
  </div>
</div>